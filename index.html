<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Test Visor</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <script type="text/javascript" src="js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui.js"></script>
    <script type="text/javascript">
        var scrollPos = 0;

        function clickOnThumbnail() {
            var idx = this.getAttribute('idx');

            scrollPos = $('#page_' + idx)[0].offsetTop / $('.pagePanel')[0].scrollHeight;

            $('.pagePanel').animate({
                scrollTop: $('#page_' + idx)[0].offsetTop
            }, 400);
        }

        function loadImages() {
            'use strict';
            var xmlns = 'http://www.w3.org/2000/svg',
                page = [],
                svg = [],
                image = [],
                imgTemp;

            for (var i = 1; i <= 10; i++) {
                // Create thumbnails
                var thumbnail = document.createElement('div'),
                    imgThumbnail = document.createElement('img'),
                    divLabel = document.createElement('div'),
                    spanLabel = document.createElement('span');

                spanLabel.innerHTML = i;
                divLabel.className = 'label';
                divLabel.appendChild(spanLabel);

                imgThumbnail.src = 'imgs/page_' + i + '.png';

                thumbnail.className = 'thumbnail';
                thumbnail.setAttribute('idx', i - 1);
                thumbnail.onclick = clickOnThumbnail;
                thumbnail.appendChild(imgThumbnail);
                thumbnail.appendChild(divLabel);

                $('.thumbpanel').append(thumbnail);

                // Create pages
                page[i - 1] = document.createElement('div');
                svg[i - 1] = document.createElementNS(xmlns, 'svg');
                image[i - 1] = document.createElementNS(xmlns, 'image');
                imgTemp = new Image();

                imgTemp.onload = function (e) {
                    var idx = this.getAttribute('idx');

                    image[idx].setAttributeNS('http://www.w3.org/1999/xlink', 'href', this.src);
                    image[idx].setAttribute('width', this.width);
                    image[idx].setAttribute('height', this.height);

                    svg[idx].setAttribute('viewBox', '0 0 ' + this.width + ' ' + this.height);
                    svg[idx].appendChild(image[idx]);

                    page[idx].className = 'page';
                    page[idx].setAttribute('id', 'page_' + idx);
                    page[idx].appendChild(svg[idx]);

                    $('.pages').append(page[idx]);
                };

                imgTemp.setAttribute('idx', i - 1);
                imgTemp.src = 'imgs/page_' + i + '.png';
            }
        }

        function toggleThumbnails() {
            scrollPos = $('.pagePanel')[0].scrollTop / $('.pagePanel')[0].scrollHeight;
            $('.thumbnails').toggle('blind', {
                direction: 'left',
                duration: 300
            }, function () {
                if ($('.thumbnails').is(':hidden')) {
                    $('#btnDoclist').removeClass('active');
                }
            });

            $('.pagePanel').animate({
                fakeAttr: 300
            }, {
                step: function (now, fx) {
                    fx.elem.scrollTop = fx.elem.scrollHeight * scrollPos;
                },
                duration: 300
            });
        }

        $(function () {

            $('#btnIndex').click(function () {
                if ($(this).hasClass('active')) {
                    $(this).removeClass('active');
                } else {

                    if ($('.thumbnails').is(':visible')) {
                        hideThumbnails();
                    }

                    $('.tools').removeClass('active');
                    $(this).addClass('active');
                }
            });

            $('#btnDoclist').click(function () {
                var btnDocklist = this;

                if ($('.thumbnails').is(':hidden')) {
                    $('.tools').removeClass('active');
                    $('#btnDoclist').addClass('active');
                }

                toggleThumbnails();
            });

            loadImages();
        });
    </script>
</head>

<body>
    <div class="frame">
        <div class="viewer">
            <div class="mainPanel">
                <div class="sidebar">
                    <div id="btnIndex" class="tools">
                        <img src="icons/index.png">
                    </div>
                    <div id="btnDoclist" class="tools active">
                        <img src="icons/doclist.png">
                    </div>
                </div>
                <div class="thumbnails">
                    <div class="thumbpanel"></div>
                </div>
                <div class="pagePanel">
                    <div class="pages"></div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>